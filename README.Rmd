# PDtools

# Installation

You can install the development version of ggVolcano as bellow:

```{r}
# install.packages("devtools")
# devtools::install_github("pigudogzyy/PDtools")
```

# ggVolcano

The goal of ggVolcano is to help users make a beautiful volcano map more easily, including general volcano plot(ggvolcano), gradient color volcano plot(gradual_volcano) and GO term volcano plot(term_volcano).

Use function ggvolcano to make a general volcano plot.

### basic use

-   Make sure you have a DEG result data containing information on differentially expressed genes (including GeneName, Log2FC, pValue, FDR).

-   If your data don't have a column named 'regulate', you can use the `add_regulate` function to add.

-   Use function `ggvolcano` to make a general volcano plot. You can use `?ggvolcano` to see the parameters of the function.

```{r}
library(PDtools)
## basic example code
# load the data
data(deg_data)
```

we can have a rough view about this data

```{r}
head(deg_data)
```

the important parameter of this deg data include

-   row
-   log2FlodChange
-   pvalue
-   padj

```{r}
# use the function -- add_regulate to add a regulate column 
# to the DEG result data. 
library(PDtools)
data <- add_regulate(deg_data, log2FC_name = "log2FoldChange",
                     fdr_name = "padj",log2FC = 1, fdr = 0.05)
table(data$regulate)
```

```{r}
# plot
ggvolcano(data, x = "log2FoldChange", y = "padj",
          label = "row", label_number = 10, output = FALSE)
```

```{r}
# Change the fill and color manually:
p1 <- ggvolcano(data, x = "log2FoldChange", y = "padj",
          fills = c("#e94234","#b4b4d8","#269846"),
          colors = c("#e94234","#b4b4d8","#269846"),
          label = "row", label_number = 10, output = FALSE)

p2 <- ggvolcano(data, x = "log2FoldChange", y = "padj",
          label = "row", label_number = 10, output = FALSE)+
  ggsci::scale_color_aaas()+
  ggsci::scale_fill_aaas()
#> Scale for 'colour' is already present. Adding another scale for 'colour', which
#> will replace the existing scale.
#> Scale for 'fill' is already present. Adding another scale for 'fill', which
#> will replace the existing scale.

library(patchwork)
p1|p2
```

## Use function `gradual_volcano` to make a gradient color volcano plot.

### basic use

-   Make sure you have a DEG result data containing information on differentially expressed genes (including GeneName, Log2FC, pValue, FDR).

-   If your data don't have a column named 'regulate', you can use the `add_regulate` function to add.

-   Use function `ggvolcano` to make a general volcano plot. You can use `?gradual_Volcano` to see the parameters of the function.

```{r}
# plot
gradual_volcano(deg_data, x = "log2FoldChange", y = "padj",
                label = "row", label_number = 10, output = FALSE)
```

```{r}
library(RColorBrewer)

# Change the fill and color manually:
p1 <- gradual_volcano(data, x = "log2FoldChange", y = "padj",
          fills = brewer.pal(5, "RdYlBu"),
          colors = brewer.pal(8, "RdYlBu"),
          label = "row", label_number = 10, output = FALSE)

p2 <- gradual_volcano(data, x = "log2FoldChange", y = "padj",
          label = "row", label_number = 10, output = FALSE)+
  ggsci::scale_color_gsea()+
  ggsci::scale_fill_gsea()
#> Scale for 'colour' is already present. Adding another scale for 'colour', which
#> will replace the existing scale.
#> Scale for 'fill' is already present. Adding another scale for 'fill', which
#> will replace the existing scale.

library(patchwork)
p1|p2
```

```{r}
data("term_data")
head(term_data)

```

```{r}
# plot
term_volcano(deg_data, term_data,
             x = "log2FoldChange", y = "padj",
             label = "row", label_number = 10, output = FALSE)
```

```{r}
library(RColorBrewer)

# Change the fill and color manually:
deg_point_fill <- brewer.pal(5, "RdYlBu")
names(deg_point_fill) <- unique(term_data$term)

term_volcano(data, term_data,
             x = "log2FoldChange", y = "padj",
             normal_point_color = "#75aadb",
             deg_point_fill = deg_point_fill,
             deg_point_color = "grey",
             legend_background_fill = "#deeffc",
             label = "row", label_number = 10, output = FALSE)
```
