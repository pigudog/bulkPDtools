```{r}
library(TwoSampleMR)
# "finn-b-E4_HYPERLIPNAS",
exposureID="finn-b-E4_HYPERLIPNAS"  
# ebi-a-GCST007542
# prot-a-1495
outcomeID="finn-b-E4_POCS"
```

```{r}
# List available GWASs
# ao <- available_outcomes()
```

```{r}
exposure_dat <- extract_instruments(exposureID, p1=5e-08, clump=TRUE)

outcome_dat <- extract_outcome_data(snps=exposure_dat$SNP, outcomes=outcomeID)

```

```{r}
dat <- harmonise_data(exposure_dat, outcome_dat)
```

```{r}
#?????????ϵ¶????????Ĺ??߱?��
outTab=dat[dat$mr_keep=="TRUE",]
write.csv(outTab, file="data/table.SNP.csv", row.names=F)
```

```{r}
#?ϵ¶???????????
mrResult=mr(dat)

mrTab=generate_odds_ratios(mrResult)
write.csv(mrTab, file="data/table.MRresult.csv", row.names=F)
mrTab
```


```{r}
#?????Է???
heterTab=mr_heterogeneity(dat)
write.csv(heterTab, file="data/table.heterogeneity.csv", row.names=F)

#??Ч?Լ???
pleioTab=mr_pleiotropy_test(dat)
write.csv(pleioTab, file="data/table.pleiotropy.csv", row.names=F)

#????ɢ??ͼ
pdf(file="Figure7/pic.scatter_plot.pdf", width=7.5, height=7)
mr_scatter_plot(mrResult, dat)
dev.off()

#ɭ??ͼ
res_single=mr_singlesnp(dat)      #?õ?ÿ?????߱?��?Խ??ֵ?Ӱ??
pdf(file="Figure7/pic.forest.pdf", width=7, height=5.5)
mr_forest_plot(res_single)
dev.off()

#©??ͼ
pdf(file="Figure7/pic.funnel_plot.pdf", width=7, height=6.5)
mr_funnel_plot(singlesnp_results = res_single)
dev.off()

#??һ???????Է???
pdf(file="Figure7/pic.leaveoneout.pdf", width=7, height=5.5)
mr_leaveoneout_plot(leaveoneout_results = mr_leaveoneout(dat))
dev.off()
```

